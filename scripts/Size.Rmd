---
title: "Gamete size analysis"
author: "jillashey"
date: "2023-04-16"
output: html_document
---

This script will analyze gamete size in Astrangia poculata over time. The data is separated into 3 treatments (ambient temperature, high temperature, field). 

## Load packages 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```

## Load data & select specific columns 
```{r}
Size  <- read.csv("data/Size.csv", header = T, na.strings = c("", "NA")) %>% 
  select(Coral.ID, Treatment, Timepoint, Sex, Scale, Average.of.Stage.One, Average.of.Stage.Two, Average.of.Stage.Three, Average.of.Stage.Four, Average.of.Stage.Five, Total.Gamates)

######### Include Site eventually 
```

##### ONLY SELECTING FIELD SAMPLES AT THE MOMENT 

## Select Female 
```{r}
Size_female <- Size %>% 
  filter(Sex == "Female") %>%
  filter(Treatment == "Field") %>%
  filter(!Timepoint == "TP0") # remove random AST sample that is labeled as FLD 

# Make avg columns numeric 
Size_female$Average.of.Stage.One <- as.numeric(Size_female$Average.of.Stage.One)
Size_female$Average.of.Stage.Two <- as.numeric(Size_female$Average.of.Stage.Two)
Size_female$Average.of.Stage.Three <- as.numeric(Size_female$Average.of.Stage.Three)
Size_female$Average.of.Stage.Four <- as.numeric(Size_female$Average.of.Stage.Four)
Size_female$Average.of.Stage.Five <- as.numeric(Size_female$Average.of.Stage.Five)
```

##  
```{r}
Size_female_long <- gather(Size_female, stage, value, Average.of.Stage.One:Average.of.Stage.Four) %>% 
  select(Coral.ID, Treatment, Timepoint, Sex, stage, value) %>% 
  na.omit()
```


## group by TP and find avg & sd of each stage 
```{r}

blah <- Size_female_long %>%
  group_by(Timepoint, stage) %>%
  summarise(avg = mean(value),
            sd = sd(value))

ggplot(blah, aes(y=avg, x=Timepoint, color = stage)) + 
  geom_point()



blah_tp2 <- blah %>% 
  filter(stage == "Average.of.Stage.Two")

ggplot(blah_tp2, aes(y=avg, x=Timepoint)) + 
  geom_point()

blah_tp2 <- blah %>% 
  filter(Timepoint == "TP2")

ggplot(blah_tp2, aes(y=avg, x=stage)) + 
  geom_point()









test <- Size_female %>% 
  group_by(Timepoint) %>%
  summarise(avg1 = mean(Average.of.Stage.One),
            sd1 = sd(Average.of.Stage.One))

test2 <- Size_female %>% 
  group_by(Timepoint) %>%
  summarise(avg2 = mean(Average.of.Stage.Two),
            sd2 = sd(Average.of.Stage.Two))

test3 <- Size_female %>% 
  group_by(Timepoint) %>%
  summarise(avg3 = mean(Average.of.Stage.Three),
            sd3 = sd(Average.of.Stage.Three))

test4 <- Size_female %>% 
  group_by(Timepoint) %>%
  summarise(avg4 = mean(Average.of.Stage.Four),
            sd4 = sd(Average.of.Stage.Four))

df_list <- list(test, test2, test3, test4)

# merge all dfs together 
all <- df_list %>%
  reduce(full_join, by = "Timepoint")
```

